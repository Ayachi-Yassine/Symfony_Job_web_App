Job Portal Symfony Project â€” Beginner's Guide

This plain-text file explains the Job Portal project in a beginner-friendly way. It covers the project's purpose, structure, main components, how the pieces work together, common developer tasks, and how to run and troubleshoot the app locally.

1) Project Overview
- Purpose: A small job portal where companies post jobs and users can apply. Includes authentication, user profiles with CV upload, job listings, single-click applications, notifications, and an admin panel to manage users, jobs and applications.
- Stack: PHP 8.2, Symfony 7.x, Doctrine ORM, Twig templates, Bootstrap front-end, MySQL (or another Doctrine-supported DB).

2) High-level Architecture
- Request flow: HTTP request goes to Symfony router -> controller -> services/repositories -> Doctrine entities -> Twig templates -> HTTP response.
- Security: Symfony Security with roles (ROLE_USER, ROLE_ADMIN).
- Files: CVs and uploads are stored under public/uploads/.
- Routes: Some routes are declared explicitly in YAML under config/routes/ to avoid attribute registration issues in certain controllers.

3) Project Structure (important files and folders)
- public/ : web root.
- src/Controller/ : controllers handling requests. Key files: AdminController.php, ProfileController.php, JobApplicationController.php, NotificationController.php.
- src/Entity/ : Doctrine entities including User.php, UserProfile.php, Job.php, JobApplication.php, Notification.php, UserActivity.php.
- templates/ : Twig templates for pages (job/show.html.twig, admin/users/edit.html.twig, base.html.twig etc.).
- config/routes/ : YAML route files created for robustness (notifications.yaml, profile.yaml, user_applications.yaml).
- src/Twig/RouteExistsExtension.php : Provides route_exists() function used in templates to avoid RouteNotFound exceptions.

4) Key Entities and Relationships (simple explanations)
- User: id, email, roles (JSON array), password, isActive, relations to profile, job applications, notifications, activities.
- UserProfile: One-to-one with User; stores fields and cvFileName pointing to public/uploads/cv/.
- Job: Job posting with title, company, description; one-to-many with JobApplication.
- JobApplication: Links a User to a Job and stores application letter, CV filename, status, timestamps.
- Notification: Notifications for users with optional relatedLink fields referencing routes.
- UserActivity: Audit entries for actions like application submitted or profile updated.

5) Important Controllers & Flows
- Authentication: SecurityController or similar handles login/logout via Symfony Security.
- Profile Flow: Users edit profile and upload CVs (PDF). ProfileController handles validation and storage; there is fallback logic when symfony/mime is missing.
- Job Application Flow (single-click apply): job/show template shows an "Apply Now" button which submits a quick apply request to JobApplicationController::apply(). The controller validates the CSRF token, checks for existing application, attaches a CV (uploaded or copied from profile), persists the application, records a UserActivity, creates a Notification, and redirects the user.
- Admin Flow: AdminController provides pages to list, edit and delete users and to manage jobs and applications. The edit user flow uses a single-choice "role" field (not roles array) and writes back to the user's roles property as an array. When deleting the currently logged-in user, the token is cleared before removal to avoid security provider errors.

6) Routes and Why Some Were Moved to YAML
- Some controllers had class-level IsGranted attributes which caused route registration problems in this codebase. To ensure routes are reliably available, explicit YAML route files were added under config/routes/.
- Templates use route_exists('name') before calling path() to guard against missing routes.

7) Twig and Templates Notes
- Twig templates render forms and content. Some filters (e.g., truncate) may be missing; use slice() and length checks as alternatives.
- Avoid using null-coalesce directly on filtered expressions when filters may return null. Use ternary checks instead.
- Use route_exists() to prevent RouteNotFound exceptions in templates that generate links.

8) Security and Roles
- Roles: ROLE_USER and ROLE_ADMIN.
- Be careful with class-level IsGranted attributes: they may block route registration or prevent ROLE_ADMIN from accessing routes intended for users. Prefer runtime checks when appropriate.

9) Common Errors and Fixes
- RouteNotFoundException in templates: Wrap path() calls with route_exists() or ensure route names match (e.g., app_jobs_show vs app_job_show).
- Array to string conversion in forms for roles: roles is stored as JSON array; use a single-choice form field called "role" in the edit form and save back as an array: setRoles([$selectedRole]).
- InvalidArgumentException on delete: Symfony's EntityUserProvider requires the user object to have an identifier when refreshing. Clear the security token (logout) before removing the currently logged-in user to prevent refresh errors.
- Missing symfony/mime for CV uploads: Install the component (composer require symfony/mime) and add try/catch fallback logic if mime guessing fails.
- Twig filter errors: Replace unsupported filters or install missing Twig extensions.

10) How to Run the Project Locally
1. In PowerShell:
   cd "c:\Users\yassi\Desktop\New folder\job-portal-symfony"
   composer install
2. Configure database URL in .env (DATABASE_URL).
3. Create/update database:
   php bin/console doctrine:database:create
   php bin/console doctrine:schema:update --force
   # or use migrations: php bin/console doctrine:migrations:migrate
4. Install assets and clear cache:
   php bin/console assets:install public
   php bin/console cache:clear
5. Start local server:
   symfony server:start -d
6. Open http://127.0.0.1:8000 in your browser.

11) Convert this text to PDF locally
- Windows options to create PDF from this TXT:
  - Open the TXT file in Notepad, choose File -> Print, select "Microsoft Print to PDF", and save the PDF.
  - Or open the TXT in Microsoft Word and use File -> Save As -> PDF.
  - If you prefer command-line conversion and install pandoc, run:
    pandoc docs\project-explanation.txt -o docs\project-explanation.pdf --pdf-engine=xelatex

12) How to Modify Common Parts
- Add a route: use controller attribute #[Route('/path', name: 'app_name')] and if necessary add a YAML entry under config/routes/.
- Add a template: create a twig file under templates/ and render it from a controller with $this->render('path.html.twig', [...]).
- Add an entity property: update the entity class, create a migration (php bin/console make:migration), then run migrations.

13) Debugging Tips
- Clear cache: php bin/console cache:clear
- Show routes: php bin/console debug:router
- Validate doctrine mapping: php bin/console doctrine:schema:validate
- Check logs in var/log/

14) Next Steps for Learning (beginner roadmap)
- Read Symfony docs: Controllers, Routing, Forms, Security, Doctrine.
- Practice by adding a small controller + template, then another field in an entity and migrate the schema.
- Learn Twig for templates and basic SQL/Doctrine queries.

15) If you want further help
- I can adjust or expand any section, add diagrams or code examples, or convert this file to PDF once you create the PDF locally or install pandoc.

File paths created:
- docs\project-explanation.md
- docs\project-explanation.html
- docs\project-explanation.txt

To convert to PDF locally quickly: open docs\project-explanation.txt in Notepad and print to "Microsoft Print to PDF".
